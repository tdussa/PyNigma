#! /bin/bash
## Reference tests generated with https://summersidemakerspace.ca/projects/enigma-machine/

RED='\033[0;31m'
GREEN='\033[0;32m'
NOCOLOR='\033[0m'

SETTINGS[0]="-r I,IV,V -s J,T,V"
SETTINGS[1]="-r V,III,I -R UCO -p GC,JU,KE,MF,OD,XY -s BDT"
SETTINGS[2]="-r II,V,IV -R RWQ -p BN,FK,OS,PW,TA,ZE -s IYM"
SETTINGS[3]="-r IV,II,I -R TRK -p BN,DU,JI,OK,TF,XC -s SFX"
SETTINGS[4]="-r II,V,III -R CTZ -p AF,BK,GJ,VQ,XH,YT -s TQO"
SETTINGS[5]="-r I,V,III -R XOM -p BX,IS,LY,NF,QO,WA -s DKV"
SETTINGS[6]="-r IV,V,II -R LDQ -p CR,FO,LI,NM,PD,XH -s IAH"
SETTINGS[7]="-r IV,I,III -R NWL -p HV,IM,JB,OT,QA,UF -s HSP"
SETTINGS[8]="-r II,IV,III -R HFZ -p FE,IB,OQ,VC,YW,ZM -s GPZ"
SETTINGS[9]="-r II,I,IV -R UBJ -p CO,GV,IH,KD,ML,RB -s PJU"
SETTINGS[10]="-r I,II,IV -R BCG -p ES,GD,IZ,JF,LN,YA -s KFQ"
SETTINGS[11]="-r I,III,V -R TGD -p AF,BW,EZ,UK,HI,OG -s DRG"
SETTINGS[12]="-r I,III,V -R TGD -p AF,BW,EZ,UK,HI,OG -s DRG"

TEXT[0]="SEGZN OLBZL QUNUB NGIPZ V"
TEXT[1]="KCYKO PAQTM KFGZO SXBGF ROQLE CFDSF LRCTR ASI"
TEXT[2]="KVJLI YHGWQ NBPPN SQBCQ HFZNZ PXETO YYFWY YJN"
TEXT[3]="IOXWA VQKDG IASTG KBGVP RDVGY CTLBE DRYCW PRE"
TEXT[4]="BQSTA YJDFE NJVUX YWWFU YSLYF IWRBJ DXMHM HBK"
TEXT[5]="LQOUK VLFRW KYGLN WOQSQ ZWUQC TPNBC FUPZK RMM"
TEXT[6]="OBSDC HESMP HJULB CKAXN JWFWH YJGKP DJUMH HZO"
TEXT[7]="YOURF LAGIS OZZJJ OIOGT AGOMV EDXZS FFFGH TRD"
TEXT[8]="GCCTL AEOSD RWILX ROJYT VTVXE HDZWS ZFFZO HXO"
TEXT[9]="LAMJR YJHFP WBCBA TXLRS AMYMO LJHAE TXABD PQO"
TEXT[10]="RAPMN HPBWJ TAADN KHSXS SMJCR OSLZS OYCVM BZT"
TEXT[11]="LOREM IPSUM DOLOR SIT AMET CONSETETUR SADIPSCING ELITR SED DIAM NONUMY EIRMOD TEMPOR INVIDUNT UT LABORE ET DOLORE MAGNA ALIQUYAM ERAT SED DIAM VOLUPTUA AT VERO EOS ET ACCUSAM ET JUSTO DUO DOLORES ET EA REBUM STET CLITA KASD GUBERGREN NO SEA TAKIMATA SANCTUS EST LOREM IPSUM DOLOR SIT AMET LOREM IPSUM DOLOR SIT AMET CONSETETUR SADIPSCING ELITR SED DIAM NONUMY EIRMOD TEMPOR INVIDUNT UT LABORE ET DOLORE MAGNA ALIQUYAM ERAT SED DIAM VOLUPTUA AT VERO EOS ET ACCUSAM ET JUSTO DUO DOLORES ET EA REBUM STET CLITA KASD GUBERGREN NO SEA TAKIMATA SANCTUS EST LOREM IPSUM DOLOR SIT AMET"
TEXT[12]="LOREM IPSUM DOLOR SIT AMET CONSETETUR SADIPSCING ELITR SED DIAM\
NONUMY EIRMOD TEMPOR INVIDUNT UT LABORE ET DOLORE MAGNA ALIQUYAM ERAT SED DIAM\
VOLUPTUA AT VERO EOS ET ACCUSAM ET JUSTO DUO DOLORES ET EA REBUM STET CLITA\
KASD GUBERGREN NO SEA TAKIMATA SANCTUS EST LOREM IPSUM DOLOR SIT AMET LOREM\
IPSUM DOLOR SIT AMET CONSETETUR SADIPSCING ELITR SED DIAM NONUMY EIRMOD TEMPOR\
INVIDUNT UT LABORE ET DOLORE MAGNA ALIQUYAM ERAT SED DIAM VOLUPTUA AT VERO EOS\
ET ACCUSAM ET JUSTO DUO DOLORES ET EA REBUM STET CLITA KASD GUBERGREN NO SEA\
TAKIMATA SANCTUS EST LOREM IPSUM DOLOR SIT AMET"

CHITEXT[0]="YOUAR EONTH EWRON GPLAC E"
CHITEXT[1]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[2]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[3]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[4]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[5]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[6]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[7]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[8]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[9]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[10]="JJLPE ONIQY LKWHT GRIHA BHESQ ZYIQZ BTIKT IDJ"
CHITEXT[11]="PQDQH BHTRG QPALA LSZ YESY RRTNPPMIJG OHIFRKNZWL QZJWX ISB BFXC HAXFQB UXFNIB KOAGAD JQIQIKMI DP UMNZJC AG YYHXWF DTNHR EWCFBJIP HEJB ZFQ BOQG OIJBAAEN CA YYQH XCH BH WVJRDGC PA TIXCJ SGJ BPEWEZN TZ DM DYPGE EKCS VGBQR VYEW ZFQVBLNDR TB HJT UVNJTSXY PHHLHSO NNU HMJKL HMFOU RGDYG GLX FAFF MNLVT ANLNC OYYPW CZW EFSW NVXEZWMANQ OMEFDHNCCY FGDBZ GIC SWVA FVHWZV AWQFIF XMNENM KBKKPJGB MW HLRNHM YX CBBJXY XFMUM ZSVFZTJG RUIY YTX RKXB FXOZVJBZ RY ROJX IUO AL RHKQGZZ IK RZAQX LLQ ABUVAYI BL QF AIFYT TRFX BOYNR JBZP THPSHTZKV KP FMC GFXDFTQV GNUWJGU GTL EDCFE HVTBI YJVEI FMM DSXR"
CHITEXT[12]="PQDQH BHTRG QPALA LSZ YESY RRTNPPMIJG OHIFRKNZWL QZJWX ISB BFXC\
HAXFQB UXFNIB KOAGAD JQIQIKMI DP UMNZJC AG YYHXWF DTNHR EWCFBJIP HEJB ZFQ BOQG\
OIJBAAEN CA YYQH XCH BH WVJRDGC PA TIXCJ SGJ BPEWEZN TZ DM DYPGE EKCS VGBQR\
VYEW ZFQVBLNDR TB HJT UVNJTSXY PHHLHSO NNU HMJKL HMFOU RGDYG GLX FAFF MNLVT\
ANLNC OYYPW CZW EFSW NVXEZWMANQ OMEFDHNCCY FGDBZ GIC SWVA FVHWZV AWQFIF XMNENM\
KBKKPJGB MW HLRNHM YX CBBJXY XFMUM ZSVFZTJG RUIY YTX RKXB FXOZVJBZ RY ROJX IUO\
AL RHKQGZZ IK RZAQX LLQ ABUVAYI BL QF AIFYT TRFX BOYNR JBZP THPSHTZKV KP FMC\
GFXDFTQV GNUWJGU GTL EDCFE HVTBI YJVEI FMM DSXR"

for item in $(seq 0 $((${#SETTINGS[@]}-1))); do
	echo "Test #${item}:"

	echo -n "  Ciphering: "
	RESULT="$(echo -n ${TEXT[${item}]} | ./PyNigma.py ${SETTINGS[${item}]})"
        if [ "${CHITEXT[${item}]}" == "${RESULT}" ]; then
		echo -e "${GREEN}Passed.${NOCOLOR}"
	else
		echo -e "${RED}FAILED!${NOCOLOR}"
		echo    "    result:   ${RESULT}"
		echo    "    expected: ${CHITEXT[${item}]}"
	fi

	echo -n "  Deciphering: "
	RESULT="$(echo -n ${CHITEXT[${item}]} | ./PyNigma.py ${SETTINGS[${item}]})"
        if [ "${TEXT[${item}]}" == "${RESULT}" ]; then
		echo -e "${GREEN}Passed.${NOCOLOR}"
	else
		echo -e "${RED}FAILED!${NOCOLOR}"
		echo    "    result:   ${RESULT}"
		echo    "    expected: ${TEXT[${item}]}"
	fi
done
